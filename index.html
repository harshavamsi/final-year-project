<html>

<head>
    <script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.js"></script>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
</head>

<body>
    <div class="container">
        <div class="page-header">
            <h1 class="text-center text-primary">Crop price prediction</h1>
        </div>
        <div class="row">
            <div class="col-md-6 text-center">
                <select class="form-control" id="main">
                    <option value="select">Select</option>
                    <option value="blackgram">Blackgram</option>
                    <option value="greenpeas">Greenpeas</option>
                    <option value="maize">Maize</option>
                    <option value="rice">Rice</option>
                    <option value="soya">Soya</option>
                    <option value="wheat">Wheat</option>
                </select>
            </div>
            <div class="col-md-6 text-center">
                <select class="form-control" id="sub">
                </select>
            </div>
        </div>

        <div class="row">
            <div class="col-md-6">
                <div class="graph1"></div>
            </div>
            <div class="col-md-6">
                <div class="graph2"></div>
            </div>
        </div>
        <div class="row">
            <div class="col-md-6">
                <div class="graph3"></div>
            </div>
            <div class="col-md-6">
                <div class="graph4"></div>
            </div>
        </div>
    </div>
    <script>
        $(document).ready(function () {
            crop = ''
            state = ''
            $("#main").change(function () {
                $(this).find("option:selected").each(function () {
                    selected = $(this).attr("value")
                    crop = selected
                    console.log(selected)
                    if (selected == 'blackgram') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        console.log("here")
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'chattisgarh')
                                .text('Chattisgarh'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'pondicher')
                                .text('Pondicherry'))
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'tamilnadu')
                                .text('Tamilnadu'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'jharkhand')
                                .text('Jharkhand'));
                        $('#sub')
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'telangana')
                                .text('Telangana'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'maharashtra')
                                .text('Maharashtra'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'orissa')
                                .text('Orissa'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'rajasthan')
                                .text('Rajasthan'));

                    } else if (selected == 'greenpeas') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'jharkhand')
                                .text('Jharkand'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'karnataka')
                                .text('Karnataka'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'rajasthan')
                                .text('Rajasthan'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'maharastra')
                                .text('Maharashtra'));
                    } else if (selected == 'maize') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'nctofdelhi')
                                .text('NctofDelhi'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'andhrapradesh')
                                .text('AndhraPradesh'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'karnataka')
                                .text('Karnataka'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'rajasthan')
                                .text('Rajasthan'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'tamilnadu')
                                .text('Tamilnadu'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'telangana')
                                .text('Telangana'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'maharashtra')
                                .text('Maharashtra'));
                    } else if (selected == 'rice') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'nctofdelhi')
                                .text('NctofDelhi'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'maharastra')
                                .text('Maharashtra'));
                    } else if (selected == 'soya') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'gujarat')
                                .text('Gujarat'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'karnataka')
                                .text('Karnataka'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'telengana')
                                .text('Telangana'));
                    } else if (selected == 'wheat') {
                        $('#sub')
                            .find('option')
                            .remove()
                            .end()
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'select')
                                .text('Select'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'nctofdelhi')
                                .text('NctofDelhi'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'karnataka')
                                .text('Karnataka'));
                        $('#sub')
                            .append($("<option></option>")
                                .attr("value", 'kerala')
                                .text('Kerala'));

                    }
                })
            })
            $("#sub").change(function () {
                $(this).find("option:selected").each(function () {

                    val = $(this).attr("value")
                    state = val
                    id1 = 'graph-' + val + '1';
                    $(".graph1").attr('id', id1);
                    id2 = 'graph-' + val + '2';
                    $(".graph2").attr('id', id2);
                    id3 = 'graph-' + val + '3';
                    $(".graph3").attr('id', id3);
                    id4 = 'graph-' + val + '4';
                    $(".graph4").attr('id', id4);
                    console.log(crop)
                    console.log(state)
                    path1 = "data/" + crop + '/output/' + crop + "_" + state + "_output.csv"
                    console.log(path1)
                    path2 = "data/" + crop + '/output/' + crop + "_" + state + "_blue.csv"
                    path3 = "data/" + crop + '/output/' + crop + "_" + state + "_orange.csv"
                    name1 = 'graph-' + val + '1';
                    name2 = 'graph-' + val + '2';
                    name3 = 'graph-' + val + '3';
                    name4 = 'graph-' + val + '4';

                    Plotly.d3.csv(path1, function (err, rows) {
                        trace00 = {
                            x: rows.map(function (row) {
                                return row['year']
                            }),
                            y: rows.map(function (row) {
                                return row['price']
                            }),
                            name: 'Date',
                            text: rows.map(function (row) {
                                return row['price']
                            }),
                            type: 'timeseries',
                            xaxis: 'x',
                            yaxis: 'y',
                        };
                        data0 = [trace00];
                        layout0 = {
                            autosize: true,
                            hovermode: 'closest',
                            title: "Modal price vs Date",
                            xaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [2014, 2018],
                                type: 'date'
                            },
                            yaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [1000, 10000],
                                type: 'linear'
                            }
                        };
                        Plotly.plot(name1, {
                            data: data0,
                            layout: layout0,
                        });



                    });
                    Plotly.d3.csv(path1, function (err, rows) {
                        trace10 = {
                            x: rows.map(function (row) {
                                return row['year']
                            }),
                            y: rows.map(function (row) {
                                return row['price']
                            }),
                            name: 'Date',
                            text: rows.map(function (row) {
                                return row['price']
                            }),
                            type: 'histogram2d',
                            xaxis: 'x',
                            yaxis: 'y',
                        };
                        data1 = [trace10];
                        layout1 = {
                            autosize: true,
                            hovermode: 'closest',
                            title: "Modal price 2D Histogram",
                            xaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [2014, 2018],
                                type: 'date'
                            },
                            yaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [1000, 10000],
                                type: 'linear'
                            }
                        };
                        Plotly.plot(name2, {
                            data: data1,
                            layout: layout1,
                        });



                    });
                    Plotly.d3.csv(path1, function (err, rows) {
                        trace20 = {

                            y: rows.map(function (row) {
                                return row['price']
                            }),
                            name: 'Date',
                            text: rows.map(function (row) {
                                return row['price']
                            }),
                            type: 'box',
                            xaxis: 'x',
                            yaxis: 'y',

                        };
                        data2 = [trace20];
                        layout2 = {
                            autosize: true,
                            hovermode: 'closest',
                            title: "Modal price Box Plot",
                            xaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [2014, 2018],
                                type: 'date'
                            },
                            yaxis: {
                                autorange: true,
                                domain: [0, 1],
                                range: [1000, 10000],
                                type: 'linear'
                            }
                        };
                        Plotly.plot(name3, {
                            data: data2,
                            layout: layout2,
                        });



                    });
                    Plotly.d3.csv(path2, function (err, csvdata1) {
                        Plotly.d3.csv(path3, function (err, csvdata2) {
                            trace30 = {
                                x: csvdata1.map(function (row) {
                                    return row['year']
                                }),
                                y: csvdata1.map(function (row) {
                                    return row['price']
                                }),
                                name: 'Actual',
                                text: csvdata1.map(function (row) {
                                    return row['price']
                                }),
                                type: 'timeseries',
                                xaxis: 'x',
                                yaxis: 'y',
                            };
                            trace40 = {
                                x: csvdata1.map(function (row) {
                                    return row['year']
                                }),
                                y: csvdata2.map(function (row) {
                                    return row['price']
                                }),
                                name: 'Predicted',
                                text: csvdata2.map(function (row) {
                                    return row['price']
                                }),
                                type: 'timeseries',
                                xaxis: 'x',
                                yaxis: 'y',
                            };
                            data3 = [trace30, trace40];
                            layout3 = {
                                autosize: true,
                                hovermode: 'closest',
                                title: "Actual vs Predicted",
                                xaxis: {
                                    autorange: true,
                                    domain: [0, 1],
                                    range: [2014, 2018],
                                    type: 'date'
                                },
                                yaxis: {
                                    autorange: true,
                                    domain: [0, 1],
                                    range: [1000, 10000],
                                    type: 'linear'
                                },
                                "showlegend": true,
                                "undefined": {
                                    "rangeslider": {
                                        "visible": true
                                    }
                                }
                            };
                            Plotly.plot(name4, {
                                data: data3,
                                layout: layout3,
                            });
                            // delete traces to avoid overlaing


                        });


                    });

                    Plotly.deleteTraces(name1, 0);
                    Plotly.deleteTraces(name2, 0);
                    Plotly.deleteTraces(name3, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);
                    Plotly.deleteTraces(name4, 0);



                })
                // delete traces to avoid overlaing


            });
        }).change();
    </script>

</body>

</html>